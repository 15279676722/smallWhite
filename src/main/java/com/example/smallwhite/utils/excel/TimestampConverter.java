package com.example.smallwhite.utils.excel;import com.alibaba.excel.converters.Converter;import com.alibaba.excel.enums.CellDataTypeEnum;import com.alibaba.excel.metadata.CellData;import com.alibaba.excel.metadata.GlobalConfiguration;import com.alibaba.excel.metadata.property.ExcelContentProperty;import java.sql.Timestamp;import java.time.format.DateTimeFormatter;/** * timestamp类型转换器 * 解决EasyExcel操作时timestamp转换报错问题 * @author: yangqiang * @create: 2020-09-14 11:33 */public class TimestampConverter implements Converter<Timestamp> {    @Override    public Class supportJavaTypeKey() {        return Timestamp.class;    }    @Override    public CellDataTypeEnum supportExcelTypeKey() {        return CellDataTypeEnum.STRING;    }    @Override    public Timestamp convertToJavaData(CellData cellData, ExcelContentProperty excelContentProperty, GlobalConfiguration globalConfiguration) throws Exception {        return Timestamp.valueOf(cellData.getStringValue());    }    @Override    public CellData convertToExcelData(Timestamp timestamp, ExcelContentProperty excelContentProperty, GlobalConfiguration globalConfiguration) throws Exception {        return new CellData<>(timestamp.toLocalDateTime().format(DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss")));    }}